6.1)Select job,sum(Sal) from emp group by job;
__________________________________________________________________________________
6.2) Select Dname from dept inner join(Select Deptno from emp group by Deptno having count(*)=(Select max(count(empno)) from emp where Prj_id='P1' group by Deptno))on DNO=DEPTNO;
______________________________________________________________________________________________________
6.3) select ename, job from emp1 where deptno in (select dno from dept1 where dname = 'Marketing' or dname = 'Research' );

ENAME      JOB
---------- ---------
Ravi       MGR
Raviraj    CLRK
spidermon  CLRK
superman   CLRK
ironman    CLRK
Thor       MGR
Loki       CLRK

_______________________________________________________________________________________________
6.4)select ename,sal from emp1 where sal>(select min(sal) from emp1);

ENAME             SAL
---------- ----------
Ravi            32000
Raviraj         24000
Raghu           45000
sundar          60000
spidermon       25000
Manu            27000
ironman         36000
Thor            62000
Mahesh          35000
Hulk            30000
Loki            32000
______________________________________________________________________________________________________________
6.5)
select deptno,avg(sal) from emp where deptno is not null group by deptno having avg(sal)>=all(select avg(sal) from emp where deptno is not null group by deptno);

___________________________________________________________________________________________________0
6.6)
select deptno , avg(sal) from dept1 where avg(sal)> all(select avg(sal)from dept1 group by d_name);

________________________________________________________________________________________________
6.7)select dname from dept,proj where dept.dno=proj.dno group by dname having count(prj_no)>1;
_______________________________________________________________________________________________________________
6.8) select count(ename) from emp where to_char(date_join,'DD')>15;



______________________________________________________________________________________________
6.9) select empno,ename,job from emp1 where job=(select job from emp1 where ename='Mahesh');

     EMPNO ENAME      JOB
---------- ---------- ---------
       101 Ravi       MGR
       106 Thor       MGR
       123 Mahesh     MGR

________________________________________________________________________________________________
6.10)
create view emp_prj_vw as select emp.*,prj_name from emp1 e,proj1 p where e.prj_id = p.prj_no and job="Marketing"; 


_______________________________________________________________________________________________
6.11) create view emp_prj_vw2 as select ename, prj_name from emp1 e, proj1 p where deptno=dno;
ENAME      PRJ_NAME
---------- ------------------------------
Ravi       bello
Ravi       todo
Ravi       app
Raviraj    bello
Raviraj    todo
Raviraj    app
spidermon  bello
spidermon  todo
spidermon  app
superman   bello
superman   todo

________________________________________________________________________________________________
6.12)
SELECT
        prj_id,
        SUM(TO_NUMBER(TO_DATE(e_date, 'YYYY-MM-DD') - TO_DATE(s_date, 'YYYY-MM-DD'))) AS total_duration,
        AVG(TO_NUMBER(TO_DATE(e_date, 'YYYY-MM-DD') - TO_DATE(s_date, 'YYYY-MM-DD'))) AS average_duration
    FROM
        task
    GROUP BY
        prj_id;

__________________________________________________________________________________________________________________
6.13)
SELECT MONTH(date_join) AS JoinMonth, COUNT(*) AS EmployeesJoined
FROM emp1
GROUP BY MONTH(date_join)
ORDER BY JoinMonth ASC;


_________________________________________________________________________________________________________________
6.14)
CREATE INDEX name_age_idx
ON Customers (first_name, age);

